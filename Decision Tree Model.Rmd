---
title: "Resume Names Decision Tree Model"
author: "Ana Imam"
date: "4/11/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

### Read and Clean Data
```{r}
resumeNames <- read.csv("ResumeNames.csv", stringsAsFactors = TRUE)
resumeNames$call <- as.factor(resumeNames$call)

summary(resumeNames)
```

### Create Train and Test Sets
```{r}
library(caret)
test_rows <- sample(1:nrow(resumeNames), nrow(resumeNames) * .7)

namesTrain <- (resumeNames[-test_rows, ])
upSampleTrain <- upSample(x=namesTrain, y = namesTrain$call)


namesTest <- (resumeNames[test_rows, ])
upSampleTest <- upSample(x=namesTest, y = namesTest$call)
```

### Build a Model for Decision Tree Train Data
```{r}
library(C50)

namesModel <- C5.0(call ~ ., data = upSampleTrain)

summary(upSampleTrain)

summary(namesModel)

plot(namesModel)
```

### Predict the Test Data
```{r}
CallPrediction <- predict(namesModel, upSampleTest)

library(gmodels)
CrossTable(upSampleTest$call, CallPrediction)
```

### Rebalance Errors
```{r}
ErrorCost <- matrix(c(0,1,4,0), nrow = 2)
library(C50)

namesCostModel <- C5.0(as.factor(call) ~., data = upSampleTrain, costs = ErrorCost)
CallCostPrediction <- predict(namesModel, upSampleTest)
library(gmodels)
CrossTable(upSampleTest$call, CallCostPrediction)
```

```






