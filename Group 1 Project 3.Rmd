---
title: "Project#3: Prediction"
author: "Group 1"
date: "3/29/2021"
output: html_document
---

```{r}
resume <- read.csv("ResumeNames.csv", stringsAsFactors = TRUE)
library(lmtest)
library(aod)
library(VGAM)
resume$name <- NULL
resume$X <- NULL
resume$minimum <- as.integer(resume$minimum)
str(resume)
```


```{r}
lm1 <- glm(call ~ ., data = resume, family = "binomial")
summary(lm1)
```

```{r}
steplm1 <- step(lm1)
```

```{r}
summary(steplm1)
```

## KNN Model
```{r}
## Make all factors dummy variables
resumemm <- as.data.frame(model.matrix(~.-1, resume))
str(resumemm)
```
```{r}
# Randomize the rows in the data (shuffling the rows)
set.seed(123)
res_random <- resumemm[sample(nrow(resumemm)),]
# #Normalize the data
normalize <- function(x) {
  return ((x - min(x)) / (max(x) - min(x)))
}
# # we are going to normalize everything 
resume_norm <- as.data.frame(lapply(res_random, normalize))
resume_z <- as.data.frame(scale(res_random[-1]))
```

```{r}
## Train and test sets for KNN
testrows <- sample(1:nrow(resume), 1400)
resume_train <- resume_z[-testrows,-match("callyes",names(resume_z))]
resume_test <- resume_z[testrows, -match("callyes",names(resume_z))]

#Now the response (aka Labels) - only the callyes column
res_train_labels <- resume_z[-testrows, "callyes"]
res_test_labels <- resume_z[testrows, "callyes"]
```

```{r}
library(class)
knum <- sqrt(nrow(resume_train))


knn_pred <- knn(train = resume_train, test = resume_test, cl = res_train_labels, k=knum)
#summary(resume_train)
```
```{r}
library(gmodels)
CrossTable(x = res_test_labels, y = knn_pred, 
           prop.chisq=FALSE)
```

